
# Техническое задание: Библиотека

**Студент:** Иванов Кирилл Владиславович

**Группа:** 2407сб2

---

## 1. Описание проекта

### 1.1 Название системы

Система управления библиотекой

### 1.2 Назначение

Данная система предназначена для автоматизации бизнес-процессов проката книг в библиотеке. Она позволяет учитывать выдачу и возврат книг, вести учет книг и читателей, рассчитывать стоимость аренды и залога, а также управлять системой штрафов и скидок для клиента.

---

## 2. Функциональные требования

### 2.1 Основные функции системы

#### Функция 1: Регистрация читателя

- **Описание:** Добавление нового читателя в систему. Пользователь вводит ФИО, контактные данные (телефон, email), дату рождения. Система автоматически генерирует уникальный номер читательского билета и определяет категорию читателя.
- **Входные данные:** ФИО, телефон, email, дата рождения.
- **Результат:** Новый читатель добавлен в базу данных, выдан номер билета.

#### Функция 2: Выдача книги

- **Описание:** Оформление выдачи книги читателю. Пользователь выбирает книгу и читателя, система определяет залоговую стоимость, генерирует уникальный номер выдачи и устанавливает дату выдачи, а также ожидаемую дату возврата, применяет систему скидок, если читатель относится к льготной категории. Пользователь проводит оплату залога и выдает книгу.
- **Входные данные:** Читатель, книга.
- **Результат:** Добавление записи о выдаче книги читателю в базу данных.

#### Функция 3: Прием книги

- **Описание:** Прием книги от читателя. Пользователь выбирает читателя и возвращаемую книгу, система фиксирует факт возврата и рассчитывает итоговую сумму к выплате. Пользователь проводит оплату проката и принимает книгу.
- **Входные данные:** Читатель, книга, штрафы.
- **Результат:** Изменение записи в базе данных о возврате и запись итоговой стоимости проката.

#### Функция 4: Оплата проката

- **Описание:** Система рассчитывает итоговую сумму на основе стоимости проката за фактический срок, учитывая штрафы за повреждения, если они были указаны. Возвращается залоговая стоимость книги и производится оплата проката.
- **Входные данные:** Платежные реквизиты.
- **Результат:** Запись итоговой стоимости проката в базу данных.

#### Функция 5: Оплата залога

- **Описание:** Система определяет залоговую стоимость книги при ее выдаче, пользователь принимает оплату у клиента через какой-либо способ оплаты.
- **Входные данные:** Платежные реквизиты
- **Результат:** Запись о выдаче книги с указанием залоговой стоимости в базу данных.

#### Функция 6: Добавление книги

- **Описание:** Добавление новой книги в систему. Пользователь вводит название, ФИО автора, жанр, залоговую стоимость, тариф проката, количество, номер стеллажа. Система автоматически генерирует уникальный номер книги.
- **Входные данные:** Название, ФИО автора, жанр, залоговая стоимость, тариф проката, количество, номер стеллажа.
- **Результат:** Новая книга добавлена в базу данных.

---

## 3. Структура базы данных

### Таблица 1: Book (Книги)

**Описание:** Хранит информацию о книгах в библиотеке

**Поля:**

- `Id` (int, PK) — уникальный идентификатор книги
- `Title` (string) — название книги
- `Author` (string) — автор книги
- `Genre` (string) — жанр книги
- `Rental_cost` (int) — стоимость проката
- `Deposit` (int) — цена депозита
- `Published_year` (date) — год издания
- `Available_copies` (int) — количество доступных экземпляров
- `Total_copies` (int) — общее количество экземпляров
- `Rack_number` (int) — номер стеллажа

**Связи:**

- Связь один-ко-многим с таблицей `Loans` (одна книга может быть выдана много раз)

### Таблица 2: Reader (Читатель)

**Описание:** Хранит информацию о читателях в библиотеке

**Поля:**

- `Id` (int, PK) — уникальный идентификатор читателя
- `Birth_date` (date) — дата рождения
- `Address` (string) — адрес проживания
- `Phone_number` (string) — контактный телефон читателя
- `Email` (string) — контактная почта читателя
- `Full_name` (string) — фамилия, имя, отчество читателя
- `Reader_category_id` (int, FK → Reader_category) — категория читателя

**Связи:**

- Связь многие-к-одному с таблицей `Reader_category` (многие читатели могут относиться к одной категории)
- Связь один-ко-многим с таблицей `Loans` (один читатель может иметь много выдач)

### Таблица 3: Loans (Прокат книги)

**Описание:** Хранит информацию о прокатах книг

**Поля:**

- `Id` (int, PK) — идентификатор проката
- `Issuance_date` (date) — дата выдачи
- `Return_date` (date?) — дата возврата *(nullable)*
- `Fine` (int) — дополнительные штрафы
- `Status` (string) — статус проката книги
- `Final_price` (int) — итоговая стоимость проката
- `Reader_id` (int, FK → Reader) — какому читателю выдана
- `Book_id` (int, FK → Book) — какая книга выдана

**Связи:**

- Связь многие-к-одному с таблицей `Reader` (каждая выдача принадлежит одному читателю)
- Связь один-ко-многим с таблицей `Book` (каждая выдача относится к одной книге)

### Таблица 4: Reader_category (Категории читателей)

**Описание:** Хранит информацию о категориях читателей

**Поля:**

- `Id` (int, PK) — уникальный идентификатор категории
- `Denomination` (string) — название категории
- `Discount` (float) — размер скидки

**Связи:**

- Связь многие-к-одному с таблицей `Reader` (одна категория может быть присвоена многим читателям)

---

## 4. Основные формы приложения

#### Форма 1: MainWindow (Главная форма)

**Назначение:** Главная форма приложения для ориентации в приложении

**Элементы управления:**

- TextBlock — поле для заголовка системы
- StackPanel — панель отображения основных кнопок 

**Действия:**

- Кнопка "Каталог книг" — открывает BookWindow для просмотра каталога книг
- Кнопка "Читатели" — открывает ReaderWindow для просмотра списка читателей
- Кнопка "Выход" - закрывает приложение

#### Форма 2: BookWindow (Каталог книг)

**Назначение:** Просмотр и управление каталогом книг библиотеки

**Элементы управления:**

- DataGrid — отображение списка книг из базы данных
- StackPanel — панель отображения основных кнопок 
- TextBlock — поле для заголовка формы
- TextBox — поле для поиска книги по названию, автору
- ComboBox — окно выбора жанра для поиска

**Действия:**

- Кнопка "Добавить книгу" — открывает EditBookWindow для добавления новой книги в каталог
- Кнопка "Удалить" — удаляет выбранную книгу после подтверждения
- Кнопка "Закрыть" — закрывает данную форму
- Кнопка "Редактировать" — открывает EditBookWindow для редактирования книги
- Кнопка "Поиск" — поиск книги по параметрам
- Кнопка "Сброс" — сброс параметров поиска

#### Форма 3: ReaderWindow (Список читателей)

**Назначение:** Просмотр и управление списком читателей библиотеки

**Элементы управления:**

- DataGrid - отображение списка читателей из базы данных
- StackPanel — панель отображения основных кнопок 
- TextBlock — поле для заголовка формы
- TextBox — поле для поиска читателя по ФИО, адресу

**Действия:**

- Кнопка "Добавить читателя" — открывает EditReaderWindow для добавления нового читателя
- Кнопка "Читательский билет" — открывает форму ReaderTicketWindow
- Кнопка "Удалить" — удаляет выбранного читателя после подтверждения
- Кнопка "Закрыть" — закрывает данную форму
- Кнопка "Редактировать" — открывает EditReaderWindow для редактирования информации о читателе
- Кнопка "Поиск" — поиск читателя по параметрам
- Кнопка "Сброс" — сброс параметров поиска

#### Форма 4: ReaderTicketWindow (Читательский билет)

**Назначение:** Просмотр читательского билета

**Элементы управления:**

- DataGrid - отображение списка книг в читательском билете
- StackPanel — панель отображения основных кнопок 
- TextBlock — поле для заголовка формы

**Действия:**

- Кнопка "Закрыть" — закрывает данную форму
- Кнопка "Выдать книгу" — открывает IssueBookWindow для выдачи книги
- Кнопка "Принять книгу" — открывает ReturnBookWindow для возврата книги

#### Форма 5: IssueBookWindow (Выдача книги)

**Назначение:** Выдача книги читателю

**Элементы управления:**

- DataGrid — отображение каталога книг
- StackPanel — панель отображения основных кнопок 
- TextBlock — поле для заголовка формы

**Действия:**

- Кнопка "Оформить выдачу" — открывает PaymentWindow для оплаты выдачи
- Кнопка "Сброс" — сброс параметров поиска
- Кнопка "Поиск" — поиск книги по параметрам
- Кнопка "Закрыть" — закрывает данную форму

#### Форма 6: ReturnBookWindow (Возврат книги)

**Назначение:** Прием книги от читателя

**Элементы управления:**

- StackPanel — панель отображения основных кнопок 
- TextBlock — поле для заголовка формы
- TextBlock — поле для отображения итоговой стоимости
- TextBlock — поле для отображения дополнительной информации
- TextBox — поле для ввода дополнительных штрафов

**Действия:**

- Кнопка "Оформить возврат" — открывает PaymentWindow для оплаты возврата
- Кнопка "Закрыть" — закрывает данную форму

#### Форма 7: PaymentWindow (Форма оплаты)

**Назначение:** Форма для оплаты услуг библиотеки

**Элементы управления:**

- ComboBox (Способ оплаты) — выбор способа оплаты
- TextBox (номер карты) — ввод номера банковской карты
- TextBox (срок действия) — ввод срока действия карты (MM/YY)
- TextBox (CVV) — ввод кода безопасности
- TextBlock (сумма) — отображение суммы к оплате

**Действия:**

- Кнопка "Оплатить" — обработка платежа
- Кнопка "Отмена" — отмена операции

#### Форма 8: EditBookWindow (Редактор книги)

**Назначение:** Добавление новой книги или редактирование информации о книге

**Элементы управления:**

- StackPanel — панель отображения основных кнопок 
- TextBlock — поле для заголовка формы
- DataGrid — отображение полей для ввода данных или редактирования

**Действия:**

- Кнопка "Сохранить" — сохраняет новую книгу или изменения
- Кнопка "Закрыть" — закрывает данную форму

#### Форма 9: EditReaderWindow (Редактор читателя)

**Назначение:** Добавление нового читателя или редактирование информации о читателе

**Элементы управления:**

- StackPanel — панель отображения основных кнопок 
- TextBlock — поле для заголовка формы
- DataGrid — отображение полей для ввода данных или редактирования

**Действия:**

- Кнопка "Сохранить" — сохраняет нового читателя или изменения
- Кнопка "Закрыть" — закрывает данную форму

---

## 5. Схема переходов между формами

### Схема навигации

#### При запуске приложения
**Запуск** → `MainWindow` (главная форма приложения)

#### Из MainWindow
**Секция "Книги":**
- Кнопка "Каталог книг" → `BookWindow` (просмотр каталога книг)

**Секция "Читатели":**
- Кнопка "Читатели" → `ReaderWindow` (просмотр списка читателей)

**Секция "Выход":**
- Кнопка "Выход" → закрытие приложения

#### Из BookWindow
**Секция "Управление книгами":**
- Кнопка "Добавить книгу" → `EditBookWindow` (режим создания новой книги)
- Кнопка "Редактировать" (выбрана книга в списке) → `EditBookWindow` (режим редактирования книги)
- Кнопка "Удалить" (выбрана книга) → диалог подтверждения → удаление книги, остаёмся в BookWindow

**Секция "Навигация":**
- Кнопка "Закрыть" → возврат на `MainWindow`

#### Из ReaderWindow
**Секция "Управление читателями":**
- Кнопка "Добавить читателя" → `EditReaderWindow` (режим создания нового читателя)
- Кнопка "Редактировать" (выбран читатель в списке) → `EditReaderWindow` (режим редактирования читателя)
- Кнопка "Удалить" (выбран читатель) → диалог подтверждения → удаление читателя, остаёмся в ReaderWindow
- Кнопка "Читательский билет" (выбран читатель) → `ReaderTicketWindow` (просмотр билета читателя)

**Секция "Навигация":**
- Кнопка "Закрыть" → возврат на `MainWindow`

#### Из ReaderTicketWindow
**Секция "Операции с книгами":**
- Кнопка "Выдать книгу" → `IssueBookWindow` (оформление выдачи книги)
- Кнопка "Принять книгу" → `ReturnBookWindow` (оформление возврата книги)

**Секция "Навигация":**
- Кнопка "Закрыть" → возврат на `ReaderWindow`

#### Из IssueBookWindow
**Секция "Оформление выдачи":**
- Кнопка "Оформить выдачу" → `PaymentWindow` (оплата залога за книгу)

**Секция "Навигация":**
- Кнопка "Закрыть" → возврат на `ReaderTicketWindow`

#### Из ReturnBookWindow
**Секция "Оформление возврата":**
- Кнопка "Оформить возврат" → `PaymentWindow` (оплата проката и возврат залога)

**Секция "Навигация":**
- Кнопка "Закрыть" → возврат на `ReaderTicketWindow`

#### Из PaymentWindow
**Секция "Оплата":**
- Кнопка "Оплатить" → обработка платежа → сообщение об успехе/ошибке
  - При успешной оплате выдачи: возврат на `ReaderTicketWindow` с обновлением статуса
  - При успешной оплате возврата: возврат на `ReaderTicketWindow` с обновлением статуса

**Секция "Отмена":**
- Кнопка "Отмена" → возврат на предыдущую форму (`IssueBookWindow` или `ReturnBookWindow`)

#### Из EditBookWindow
**Секция "Сохранение":**
- Кнопка "Сохранить" → сохранение данных книги → возврат на `BookWindow` (обновление списка книг)

**Секция "Навигация":**
- Кнопка "Закрыть" → возврат на `BookWindow` без сохранения

#### Из EditReaderWindow
**Секция "Сохранение":**
- Кнопка "Сохранить" → сохранение данных читателя → возврат на `ReaderWindow` (обновление списка читателей)

**Секция "Навигация":**
- Кнопка "Закрыть" → возврат на `ReaderWindow` без сохранения

### Логика переходов между основными операциями:

1. **Полный цикл выдачи книги:**
   `MainWindow` → `ReaderWindow` → `ReaderTicketWindow` → `IssueBookWindow` → `PaymentWindow` → `ReaderTicketWindow`

2. **Полный цикл возврата книги:**
   `MainWindow` → `ReaderWindow` → `ReaderTicketWindow` → `ReturnBookWindow` → `PaymentWindow` → `ReaderTicketWindow`

3. **Управление каталогом книг:**
   `MainWindow` → `BookWindow` → `EditBookWindow` → `BookWindow`

4. **Управление читателями:**
   `MainWindow` → `ReaderWindow` → `EditReaderWindow` → `ReaderWindow`